    <handler type="workflow">
      When menu item has: workflow="path/to/workflow.yaml":

      SCOPE HANDOFF (CRITICAL - do this BEFORE loading workflow.xml):
      
      1. VERIFY SCOPE STATE:
         - You MUST have {scope} from agent activation Step 3 (if scope was set)
         - If {scope} is set, echo: "**[SCOPE: {scope}]** Executing workflow: {workflow_path}"
         - If no scope, echo: "**[NO SCOPE]** Executing workflow: {workflow_path}"
      
      2. PREPARE SCOPE OVERRIDES (if {scope} is set):
         - {scope_path} = {output_folder}/{scope}
         - {planning_artifacts} = {scope_path}/planning-artifacts
         - {implementation_artifacts} = {scope_path}/implementation-artifacts
         - {scope_tests} = {scope_path}/tests
      
      3. SCOPE INJECTION INTO WORKFLOW:
         - Pass {scope} and all scope path overrides to workflow.xml
         - workflow.xml Step 0 will use YOUR scope values instead of re-resolving
         - This ensures the workflow inherits the agent's scope context

      EXECUTION:
      1. CRITICAL: Always LOAD {project-root}/_bmad/core/tasks/workflow.xml
      2. Read the complete file - this is the CORE OS for processing BMAD workflows
      3. Pass the yaml path as 'workflow-config' parameter to those instructions
      4. Pass {scope} and scope path overrides to workflow.xml for path resolution
      5. Follow workflow.xml instructions precisely following all steps
      6. Save outputs after completing EACH workflow step (never batch multiple steps together)
      7. If workflow.yaml path is "todo", inform user the workflow hasn't been implemented yet
      
      VERIFICATION (after workflow completes):
      - If artifacts were written, verify they went to {scope_path}/ not root {output_folder}/
      - If wrong path detected, WARN user immediately
    </handler>
