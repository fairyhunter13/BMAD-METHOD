    <step n="1">Load persona from this current agent file (already in context)</step>
    <step n="2">üö® IMMEDIATE ACTION REQUIRED - BEFORE ANY OUTPUT:
        - Load and read {project-root}/_bmad/{{module}}/config.yaml NOW
        - Store ALL fields as session variables: {user_name}, {communication_language}, {output_folder}
        - VERIFY: If config not loaded, STOP and report error to user
        - DO NOT PROCEED to step 3 until config is successfully loaded and variables stored
    </step>
    <step n="3">üîç SCOPE CONTEXT LOADING (CRITICAL for artifact isolation - PARALLEL-SAFE):
        PRIORITY ORDER for scope resolution (first match wins):
        
        3a. CHECK INLINE SCOPE (HIGHEST PRIORITY - PARALLEL-SAFE):
            - Check if {scope} was passed from the slash command that activated this agent
            - Formats: /agent-name --scope auth, /agent-name --scope=auth, /agent-name auth
            - If inline scope provided, use it and skip to 3e
            - Echo: "**[SCOPE: {scope}]** Using inline scope"
        
        3b. CHECK CONVERSATION MEMORY (PARALLEL-SAFE):
            - Check if scope was set earlier in THIS conversation
            - If you remember a scope from this conversation, use it and skip to 3e
            - Echo: "**[SCOPE: {scope}]** Using scope from conversation context"
        
        3c. CHECK BMAD_SCOPE ENV VAR (PARALLEL-SAFE):
            - If BMAD_SCOPE environment variable is set, use its value as {scope}
            - Echo: "**[SCOPE: {scope}]** Using scope from BMAD_SCOPE env var"
        
        3d. FALLBACK TO .bmad-scope FILE (NOT PARALLEL-SAFE; OPTIONAL):
            - Check for .bmad-scope file in {project-root}
            - If exists, parse YAML and check enabled/disabled:
              - If enabled: false OR disabled: true ‚Üí IGNORE this file (treat as not found)
              - Legacy files without enabled/disabled keys are treated as enabled
              - If enabled AND active_scope present ‚Üí store as {scope}
            - WARNING: This file is shared across ALL sessions - not parallel-safe!
            - If used, echo: "**[SCOPE: {scope}]** Using scope from .bmad-scope (shared file - not parallel-safe)"
            - If .bmad-scope does not exist (or is disabled), continue without scope (backward compatible)
        
        3e. VALIDATE SCOPE (if {scope} is set):
            - Load scope registry: {project-root}/_bmad/_config/scopes.yaml
            - If scopes.yaml is missing, echo warning and clear {scope} (scope system not initialized)
            - Verify scope exists and status is "active" (NOT archived)
            - If invalid or archived:
              - Echo warning and clear {scope}
              - Continue without scope (backward compatible)
        
        3f. APPLY SCOPE OVERRIDES (if {scope} is set):
            - STORE THESE OVERRIDE VALUES for the entire session:
              - {scope_path} = {output_folder}/{scope}
              - {planning_artifacts} = {scope_path}/planning-artifacts  (OVERRIDE config.yaml!)
              - {implementation_artifacts} = {scope_path}/implementation-artifacts  (OVERRIDE config.yaml!)
              - {scope_tests} = {scope_path}/tests
            - Load global context: {output_folder}/_shared/project-context.md
            - Load scope context if exists: {scope_path}/project-context.md
            - Merge contexts (scope extends global)
        
        3g. REMEMBER SCOPE FOR CONVERSATION:
            - Once scope is resolved, REMEMBER IT for the rest of this conversation
            - Do NOT re-read .bmad-scope file later in this session
            - Inline scope from any subsequent command updates the conversation scope
        
        - IMPORTANT: Config.yaml contains static pre-resolved paths. When scope is active,
          you MUST use YOUR overridden values above, not config.yaml values for these variables.
        - If no scope from any source, use config.yaml paths as-is (backward compatible)
          and echo: "**[NO SCOPE]** Running without scope isolation"
    </step>
    <step n="4">Remember: user's name is {user_name}</step>
    {AGENT_SPECIFIC_STEPS}
    <step n="{MENU_STEP}">Show greeting using {user_name} from config (include "[SCOPE: {scope}]" if scope is set), communicate in {communication_language}, then display numbered list of ALL menu items from menu section</step>
    <step n="{HELP_STEP}">Let {user_name} know they can type command `/bmad-help` at any time to get advice on what to do next, and that they can combine that with what they need help with <example>`/bmad-help where should I start with an idea I have that does XYZ`</example></step>
    <step n="{HALT_STEP}">STOP and WAIT for user input - do NOT execute menu items automatically - accept number or cmd trigger or fuzzy command match</step>
    <step n="{INPUT_STEP}">On user input: Number ‚Üí execute menu item[n] | Text ‚Üí case-insensitive substring match | Multiple matches ‚Üí ask user to clarify | No match ‚Üí show "Not recognized"</step>
    <step n="{EXECUTE_STEP}">When executing a menu item: Check menu-handlers section below - extract any attributes from the selected menu item (workflow, exec, tmpl, data, action, validate-workflow) and follow the corresponding handler instructions. CRITICAL: Pass {scope} to the handler - it needs this for artifact paths!</step>
